АНАЛИЗ БАЗЫ ЗНАНИЙ
====================

1. КОЛИЧЕСТВО ФАЙЛОВ .md:
   86 файлов .md всего (рекурсивно по всем подпапкам)

2. ПОДПАПКИ В knowledge_base/:
   - 00_Общая_теория/
   - 01_общедомовое_имущество/
   - 01_Федеральные_законы/
   - 02_Кодексы_и_ответственность/
   - 02_ТСЖ_и_согласования/
   - 03_коммерческая_недвижимость/
   - 03_Своды_правил_и_СП/
   - 04_Москва/
   - 04_шаблоны_документов/
   - 05_Московская_область/
   - 05_нормативная_база/
   - 06_кейсы_судебная_практика/
   - 06_Процедуры_и_документы/
   - 07_объекты_культурного_наследия_ОКН/
   - 09_ИИ_консультант/

   Всего 15 подпапок + 2 файла в корне

3. ОСНОВНЫЕ МЕТОДЫ В КЛАССЕ KnowledgeBaseRAG (kb_rag.py):
   - __init__(knowledge_dir: str) - инициализация с указанием директории
   - index_markdown_files() - индексация всех .md и .txt файлов из папки и подпапок
   - get_rag_context(query: str, max_chunks: int = 3) - получение релевантного контекста
   - _extract_relevant_snippet() - извлечение релевантного фрагмента из документа
   - get_context(query: str) - алиас для get_rag_context (для совместимости)

4. ИСПОЛЬЗОВАНИЕ kb.get_rag_context В bot_unified.py:
   - В функции get_rag_context(): return kb.get_rag_context(question)
     * Это основная функция для получения контекста из базы знаний
     * Вызывается из dialog_handler и quick_handler для поиска релевантной информации

   - В команде /test_rag: test_context = kb.get_rag_context("перепланировка квартиры")
     * Тестовая команда для проверки работы RAG-системы
     * Показывает первые 500 символов найденного контекста

5. ТЕХНИЧЕСКИЕ ДЕТАЛИ RAG-СИСТЕМЫ:
   - Простой поиск по ключевым словам (не нейронный поиск)
   - Оценка релевантности по количеству совпадений ключевых слов
   - Извлечение сниппетов контекста вокруг найденных ключевых слов
   - Поддержка до 3 наиболее релевантных документов
   - Обработка исключений при чтении файлов

6. ИНИЦИАЛИЗАЦИЯ В bot_unified.py:
   kb = KnowledgeBaseRAG(KNOWLEDGE_DIR)
   kb.index_markdown_files()
   - Создается глобальный экземпляр kb
   - Индексация происходит при запуске бота
   - Если файл не найден, kb = None и RAG отключается
