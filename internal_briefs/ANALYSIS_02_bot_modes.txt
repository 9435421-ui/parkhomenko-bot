–ê–ù–ê–õ–ò–ó –†–ï–ñ–ò–ú–û–í –†–ê–ë–û–¢–´ –ë–û–¢–ê bot_unified.py
==========================================

1. –§–£–ù–ö–¶–ò–Ø QUIZ_HANDLER:
   –î–ê, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–∫—Ç–∏–≤–Ω–æ. –≠—Ç–æ –æ—Å–Ω–æ–≤–Ω–æ–π —Ä–µ–∂–∏–º —Å–±–æ—Ä–∞ –∑–∞—è–≤–æ–∫.

   –ö–û–õ–ò–ß–ï–°–¢–í–û –®–ê–ì–û–í: 8 –æ—Å–Ω–æ–≤–Ω—ã—Ö —à–∞–≥–æ–≤ + –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π —à–∞–≥ 3.5

   –ü–û–î–†–û–ë–ù–´–ï –®–ê–ì–ò –ö–í–ò–ó–ê:
   - –®–ê–ì 2: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∫–æ–Ω—Ç–∞–∫—Ç ("–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–± —Å–≤—è–∑–∏ (WhatsApp/–ø–æ—á—Ç–∞/–¥—Ä—É–≥–æ–π –Ω–æ–º–µ—Ä) ‚Äî –Ω–∞–ø–∏—à–∏—Ç–µ –µ–≥–æ, –∏–ª–∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ ¬´–Ω–µ—Ç¬ª.")
     * –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ state.extra_contact
     * –õ–æ–≥–∏–∫–∞: "–Ω–µ—Ç" –∏–ª–∏ "–¥–∞" ‚Üí None (–Ω–µ—Ç –¥–æ–ø. –∫–æ–Ω—Ç–∞–∫—Ç–∞), –∏–Ω–∞—á–µ —Ç–µ–∫—Å—Ç

   - –®–ê–ì 3: –í—ã–±–æ—Ä —Ç–∏–ø–∞ –æ–±—ä–µ–∫—Ç–∞ (–∫–Ω–æ–ø–∫–∏: –ö–≤–∞—Ä—Ç–∏—Ä–∞, –ö–æ–º–º–µ—Ä—Ü–∏—è, –î–æ–º)
     * –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ state.object_type

   - –®–ê–ì 3.5 (–ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π, –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–∏–ø–∞ –æ–±—ä–µ–∫—Ç–∞):
     * –ï–°–õ–ò "–î–æ–º": –í—ã–±–æ—Ä –º–∞—Ç–µ—Ä–∏–∞–ª–∞ –¥–æ–º–∞ (–∫–Ω–æ–ø–∫–∏: –ö–∏—Ä–ø–∏—á, –ë—Ä—É—Å, –ö–∞—Ä–∫–∞—Å, –ü–µ–Ω–æ–±–ª–æ–∫, –î—Ä—É–≥–æ–µ)
       ‚Üí –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ state.house_material
     * –ï–°–õ–ò "–ö–æ–º–º–µ—Ä—Ü–∏—è": –í—ã–±–æ—Ä –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è (–∫–Ω–æ–ø–∫–∏: –û–±—â–µ–ø–∏—Ç, –¢–æ—Ä–≥–æ–≤–ª—è, –û—Ñ–∏—Å, –ú–µ–¥–∏—Ü–∏–Ω–∞, –î—Ä—É–≥–æ–µ)
       ‚Üí –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ state.commercial_purpose
     * –ï–°–õ–ò "–ö–≤–∞—Ä—Ç–∏—Ä–∞": –®–∞–≥ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è

   - –®–ê–ì 4: –ì–æ—Ä–æ–¥/—Ä–µ–≥–∏–æ–Ω (—Ç–µ–∫—Å—Ç–æ–≤—ã–π –≤–≤–æ–¥)
     * –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ state.city

   - –®–ê–ì 5: –≠—Ç–∞–∂ –∏ —ç—Ç–∞–∂–Ω–æ—Å—Ç—å (–Ω–∞–ø—Ä–∏–º–µ—Ä: "5/9")
     * –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ state.floor –∏ state.total_floors

   - –®–ê–ì 6: –°—Ç–∞—Ç—É—Å –ø–µ—Ä–µ–ø–ª–∞–Ω–∏—Ä–æ–≤–∫–∏ ("–≤—ã–ø–æ–ª–Ω–µ–Ω–∞" –∏–ª–∏ "–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è")
     * –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ state.remodeling_status

   - –®–ê–ì 7: –û–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π (—Ç–µ–∫—Å—Ç–æ–≤—ã–π –≤–≤–æ–¥)
     * –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ state.change_plan

   - –®–ê–ì 8: –°—Ç–∞—Ç—É—Å –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –ë–¢–ò + –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ
     * –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ state.bti_status
     * –í—ã–∑—ã–≤–∞–µ—Ç—Å—è save_lead_and_notify() –∏ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –∫–≤–∏–∑

2. –§–£–ù–ö–¶–ò–Ø DIALOG_HANDLER:
   –î–ê, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è. –≠—Ç–æ —Ä–µ–∂–∏–º –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–≥–æ –¥–∏–∞–ª–æ–≥–∞ —Å –ò–ò-–∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç–æ–º.

   –î–û–°–¢–£–ü–ù–û–°–¢–¨: –ï—Å—Ç—å –∫–Ω–æ–ø–∫–∞ –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –≤ —ç—Ç–æ—Ç —Ä–µ–∂–∏–º.
   - –í quick_handler –ø–æ—Å–ª–µ 2-—Ö –æ—Ç–≤–µ—Ç–æ–≤ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –∫–Ω–æ–ø–∫–∏:
     "üí¨ –ü–µ—Ä–µ–π—Ç–∏ –≤ –¥–∏–∞–ª–æ–≥" (callback_data="mode_dialog")
     "üìù –û—Å—Ç–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É" (callback_data="mode_quiz")
   - –¢–∞–∫–∂–µ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ callback "mode_dialog" –≤ mode_select_handler

3. –§–£–ù–ö–¶–ò–Ø QUICK_HANDLER:
   –î–ê, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è. –≠—Ç–æ —Ä–µ–∂–∏–º –±—ã—Å—Ç—Ä–æ–π –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ (1-2 –æ—Ç–≤–µ—Ç–∞).

   –î–û–°–¢–£–ü–ù–û–°–¢–¨: –ï—Å—Ç—å –∫–Ω–æ–ø–∫–∞ –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –≤ —ç—Ç–æ—Ç —Ä–µ–∂–∏–º.
   - –í mode_select_handler –µ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∞ callback "mode_quick"
   - –ü–æ—Å–ª–µ 2-—Ö –æ—Ç–≤–µ—Ç–æ–≤ –≤ QUICK —Ä–µ–∂–∏–º–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç—Å—è –ø–µ—Ä–µ–π—Ç–∏ –≤ –¥–∏–∞–ª–æ–≥ –∏–ª–∏ –æ—Å—Ç–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É

4. –§–£–ù–ö–¶–ò–Ø SHOW_MAIN_MENU:
   –ö–ù–û–ü–ö–ò –í –ú–ï–ù–Æ:
   - –¢–æ–ª—å–∫–æ 1 –∫–Ω–æ–ø–∫–∞: "üìù –û—Å—Ç–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É" (callback_data="mode_quiz")

   –≠—Ç–æ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é, –∫–æ—Ç–æ—Ä–æ–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ /start –∏ —É—Å–ø–µ—à–Ω–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

–û–°–û–ë–ï–ù–ù–û–°–¢–ò –†–ï–ñ–ò–ú–û–í:
- QUIZ: –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∑–∞—è–≤–∫–∏ (8 —à–∞–≥–æ–≤)
- DIALOG: –°–≤–æ–±–æ–¥–Ω—ã–π —Ä–∞–∑–≥–æ–≤–æ—Ä —Å –ò–ò, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏, –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–∏—Ç—å —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞
- QUICK: –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è (2 –æ—Ç–≤–µ—Ç–∞), –∑–∞—Ç–µ–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –ø–µ—Ä–µ–π—Ç–∏ –≤ –¥–∏–∞–ª–æ–≥ –∏–ª–∏ –∫–≤–∏–∑
- –í—Å–µ —Ä–µ–∂–∏–º—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç YandexGPT + RAG –¥–ª—è –æ—Ç–≤–µ—Ç–æ–≤
- –ü–µ—Ä–µ—Ö–æ–¥ –º–µ–∂–¥—É —Ä–µ–∂–∏–º–∞–º–∏ –≤–æ–∑–º–æ–∂–µ–Ω —á–µ—Ä–µ–∑ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –∫–Ω–æ–ø–∫–∏

–¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –î–ï–¢–ê–õ–ò:
- –ö–∞–∂–¥—ã–π —Ä–µ–∂–∏–º –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–æ–≥–ª–∞—Å–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (privacy_accepted)
- –ò—Å—Ç–æ—Ä–∏—è –¥–∏–∞–ª–æ–≥–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ state.dialog_history
- –ü—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è –ª–∏–¥
- –í—Å–µ —Ä–µ–∂–∏–º—ã –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –≥–æ–ª–æ—Å–æ–≤—ã–µ –∏ –∞—É–¥–∏–æ —Å–æ–æ–±—â–µ–Ω–∏—è —á–µ—Ä–µ–∑ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—é
