# BRIEF_утро_бот_24_01.md

## 1. Цель ближайших сессий

- Аккуратно доработать консультанта/квиз и обвязку вокруг него (privacy, /start, тексты, меню), не ломая прод.  
- Работать мелкими, проверяемыми шагами через VS Code‑агента.

## 2. Текущая точка

- Код локально и на сервере синхронен, `git status` чистый. [git-scm](https://git-scm.com/book/it/v2/Git-Basics-Recording-Changes-to-the-Repository)
- В `start_handler` уже есть:
  - проверка `if not consent.privacy_accepted` с privacy‑сообщением и inline‑кнопкой «Продолжить» (`callback_data="consent_accept"`);  
  - ветка для пользователей с уже принятым согласием → сброс `state.mode`, `state.quiz_step`, вызов `show_main_menu(user_id)`. [perplexity](https://www.perplexity.ai/search/0a9fb125-7b7f-46aa-a98f-6f2f33a770af)
- Есть обработчик `consent_accept`, который:
  - ставит `consent.privacy_accepted = True`,  
  - сбрасывает `state.mode`, `state.quiz_step`,  
  - вызывает `show_main_menu(user_id)`. [perplexity](https://www.perplexity.ai/search/0a9fb125-7b7f-46aa-a98f-6f2f33a770af)

## 3. Роль помощника (меня)

- Технический руководитель и конструктор логики:  
  - продумываю flow (состояния, переходы, где показывать какие экраны);  
  - формулирую точные ТЗ для VS Code‑агента;  
  - проверяю результат (логику и риски).  
- Ты отвечаешь за:
  - текст, тон и «человеческую» часть;  
  - финальное решение, что оставляем в прод.

## 4. Специфика работы с VS Code

### Принципы

- Только **маленькие задачи**, затрагивающие ограниченный участок кода.  
- Одна задача = один чёткий промпт → агент вносит изменения → ты сразу проверяешь diff/кусок кода.  
- Никаких «переписать весь файл» и больших рефакторингов.

### Шаблон промпта для агента

Всегда примерно так:

1. Короткий контекст:  
   - «Project: PARKHOMENKO_BOT, file: bot_unified.py.»  
2. Чёткая задача:  
   - «Find function X, modify only Y, do not touch Z.»  
3. Ограничения:  
   - «Do not change quiz logic, DB schema, or other handlers.»  
4. Что показать в отчёте:  
   - «Show me only the updated function/handler.»

## 5. Типовой цикл работы (чтобы не забывать)

1. **Перед задачей**  
   - Проверить `git status` (должно быть чисто).  
   - Если не чисто — решить: закоммитить или откатить.

2. **Дать ТЗ агенту**  
   - Формулировать одну узкую задачу (пример: «только /start», «только обработчик consent_accept», «только текст сообщения»).

3. **Проверить результат**  
   - Попросить показать конкретный фрагмент кода (функцию/хендлер).  
   - Визуально проверить: логика, отступы, нет ли побочных изменений.

4. **Только потом**  
   - Локально протестировать (при необходимости).  
   - `git commit` → `git push` → на сервере `git pull` и перезапуск.

***

Если утром ты напишешь «запускаем по брифу», я буду держаться этой схемы: предлагать маленькие ТЗ для VS Code, следить, чтобы не полезли в лишнее, и помогать проверять каждый шаг.