# Бриф проекта: ТЕРИОН (ИИ‑консультант и Контент-Агент)

## 1. Проект и цель
Проект «ТЕРИОН» — это экосистема для автоматизации консалтинга по перепланировкам и ведения тематических сообществ.
**Цель:** Конвертация трафика из TG и VK в квалифицированные лиды через экспертную поддержку ИИ.

## 2. Технологический стек (V2.0)
- **Движок:** Aiogram 3.7 (Асинхронный режим).
- **База данных:** SQLite (parkhomenko_bot.db).
- **Интеграции:**
  - **Telegram API:** Основной интерфейс взаимодействия.
  - **VK API:** Кросс-постинг экспертного контента на стены групп.
  - **Yandex Cloud:**
    - **YandexGPT:** Интеллектуальные консультации (Антон).
    - **Yandex SpeechKit:** Транскрибация голосовых сообщений (STT).
    - **Yandex Art:** Генерация уникальных обложек для постов.
  - **OpenRouter:** Альтернативный движок генерации контента.

## 3. Функциональные модули

### 3.1. Квиз-воронка (Gateway)
Строгий 7-шаговый сбор данных перед передачей эксперту:
1.  **Город/Регион.**
2.  **Тип объекта** (Квартира/Коммерция).
3.  **Этаж и этажность** дома.
4.  **Площадь** объекта.
5.  **Статус** (Планируемая или уже выполненная перепланировка).
6.  **Описание** (Что именно меняется).
7.  **Загрузка плана/фото** (PDF/JPG).
*Перед началом квиза обязателен сбор контакта пользователя.*

### 3.2. Медиа-Антон (Контент-Агент)
- **Режим интервью:** Сбор фактов от эксперта в топике «Черновики» (ID 85) и превращение их в посты с помощью ИИ.
- **Кросс-постинг:** Одновременная публикация утвержденных постов в Telegram-канал и сообщество VK.
- **Инфо-Поток:** Автоматическое предложение тем на основе праздников и новостей в топик «Сезонный контент» (ID 87).

### 3.3. Шпион (Мониторинг)
- Асинхронное отслеживание ключевых слов («перепланировка», «снос стены» и др.) в подключенных чатах.
- Автоматическая пересылка потенциальных лидов в канал уведомлений `NOTIFICATIONS_CHANNEL_ID`.

### 3.4. Интеллектуальный помощник (RAG)
- Ответы на вопросы пользователей на основе базы знаний (80+ документов законодательства РФ).

## 4. Структура проекта
- `main.py` — Точка входа, регистрация роутеров.
- `handlers/` — Логика квиза, контента, мониторинга и диалогов.
- `services/` — Интеграции с VK, Yandex Art и внешними API.
- `keyboards/` — Динамические клавиатуры и Mini App.
- `config.py` — Управление конфигурацией через `.env`.

## 5. Безопасность и регламент
- Все секреты (токены, ключи) хранятся строго в `.env`.
- Прямое редактирование текстов вопросов квиза запрещено без согласования с техрудом.
- Маршрутизация лидов по топикам: 2 (Квартиры), 5 (Коммерция), 8 (Дома).
