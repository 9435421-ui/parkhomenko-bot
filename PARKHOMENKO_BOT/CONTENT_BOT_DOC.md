# Техническое описание: Контент-бот «ТЕРИОН»

**Цель:** Автоматизация прогрева аудитории через генерацию экспертного контента, управление контент-планом и автоматизированную работу с лояльностью.

## 1. Архитектура и структура
Проект построен на базе библиотеки `telebot` (pyTelegramBotAPI) для синхронной работы с процессами генерации и интеграции.

*   **`bot_unified.py`**: Основной файл бота. Обработка команд, шлюз контактов, 7-шаговый квиз, STT (Yandex SpeechKit).
*   **`content_agent.py`**: Интеграция с LLM (YandexGPT/OpenAI). Генерация постов, поздравлений и приветствий.
*   **`auto_poster.py`**: Фоновый сервис для автоматической публикации утвержденных постов в канал.
*   **`kb_rag.py`**: Модуль RAG для поиска по базе знаний в `/knowledge_base`.
*   **`services/vk_service.py`**: Модуль интеграции с VK.

## 2. Реализованный функционал

### А. Генерация контента
*   Команда `/generate_content`: Создание 7 постов на неделю (Экспертиза, Живой, Новость).
*   Система модерации: Утверждение/удаление черновиков через inline-кнопки в админ-группе.
*   Авто-постинг: Публикация в канал по расписанию (10:00).

### Б. Лояльность
*   `/add_subscriber`: Регистрация дней рождения.
*   `/generate_greetings`: Массовая генерация поздравлений для именинников.
*   `/generate_welcome`: Приветственные посты для новых клиентов.

### В. Квиз и STT
*   7-шаговый сбор заявок (Город, Объект, Этаж, Статус, Описание, БТИ, Контакт).
*   Распознавание голосовых сообщений через Yandex SpeechKit.

## 3. Статус и заглушки (TODO)

| Модуль | Статус | Описание |
| :--- | :--- | :--- |
| **VK Service** | ❌ Заглушка | В `services/vk_service.py` методы только имитируют работу (печать в консоль). |
| **OCR / Анализ планов** | ❌ Заглушка | Хэндлер `handle_files` сообщает о доступности в будущем. |
| **Генерация видео** | ❌ Заглушка | Метод `generate_video` возвращает текст о недоступности. |
| **Image Prompts** | ⚠️ Частично | Промпты генерируются только для определенных типов постов. |

## 4. Группа мониторинга
Все логи и черновики направляются в группу `LEADS_GROUP_CHAT_ID` по топикам:
*   `85`: Черновики и идеи
*   `87`: Сезонный контент
*   `88`: Логи и ошибки
