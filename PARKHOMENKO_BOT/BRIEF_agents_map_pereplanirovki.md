# Карта агентов проекта «Пархоменко и компания» — перепланировки

## Роль Comet

Comet — технический руководитель и архитектограф проекта:
- проектирует архитектуру ботов и ИИ-агентов;
- формулирует ТЗ для VS Code-агента (Cline);
- готовит фрагменты кода и структуры промптов;
- отвечает за целостность логики и минимизацию багов;
- не принимает финальных бизнес-решений (это делает Юлия), но предлагает варианты решений.

Принципы работы Comet:
- если данных не хватает — прямо пишет, что информации нет, и не фантазирует;
- ошибки допускаются, но должны быть явно признаны и исправлены в следующих версиях брифа/кода;
- все изменения через VS Code-агента делаются по схеме: PLAN MODE → ACT MODE → отчёт.

---

## Цель карты агентов

Сделать понятную карту ИИ-агентов вокруг проекта перепланировок, чтобы:
- было ясно, какие роли закрываются ИИ и где остаётся зона ответственности людей;
- можно было безболезненно добавлять новых агентов (бот, канал, лендинг, оплаты);
- использовать один и тот же подход взаимодействия с VS Code-агентом.

---

## Текущий Bot Agent: Антон (перепланировки)

### Задачи Антона

- **DIALOG**
  Глубокие консультации по перепланировкам:
  - RAG по базе знаний (83+ документов);
  - учёт истории диалога;
  - распознавание frustration и корректировка тона;
  - мягкий переход к заявке без навязчивых продаж и без озвучивания цен.

- **QUICK**
  Быстрая консультация:
  - 1–2 коротких ответа (250–350 символов);
  - опора на тот же system_prompt и историю;
  - после 1–2 ответов предлагает перейти в DIALOG или квиз.

- **QUIZ**
  Сбор заявки (8 шагов):
  - дополнительный контакт;
  - тип объекта (квартира/коммерция/дом);
  - город/регион, этаж/этажность;
  - статус перепланировки, описание работ;
  - статус документов БТИ;
  - формирование и отправка лида в нужный тред.

- **Транскрибация**
  Приём голосовых и аудио:
  - Yandex SpeechKit STT (ru-RU);
  - распознанный текст передаётся в DIALOG/QUICK/QUIZ как обычное сообщение;
  - UX-фраза при первом голосовом: «Расшифровала ваше голосовое сообщение и сейчас отвечу по сути».

### Входы Антона

- Текстовые сообщения в Telegram.
- Голосовые сообщения (voice).
- Аудиофайлы (audio).
- В перспективе — планы помещений как файлы.

### Выходы Антона

- Ответы пользователю во всех режимах.
- Лиды в рабочую группу:
  - минимальный контакт-лид (Новый контакт, без заявки);
  - полные заявки с объектом, городом, БТИ и описанием работ;
  - пояснительные записки менеджеру (manager brief).

### Основные файлы

- `bot_unified.py`
- `kb_rag.py`
- `knowledge_base/` (структурированная база MD-файлов)
- Брифы проекта (папка с BRIEF_*.md)

---

## План дополнительных агентов для перепланировок

### 1. Content Agent — ведение канала по перепланировкам

**Задачи:**
- Формировать контент-план канала:
  - рубрики: кейсы, разборы норм, FAQ, «разбор полётов» жилищной инспекции, истории клиентов;
  - календарь публикаций, включая гос.праздники и важные даты.
- Генерировать черновики постов:
  - образовательные посты;
  - новости по перепланировкам;
  - поздравления подписчиков с праздниками.
- Подготавливать ответы на комментарии/вопросы под постами:
  - в стиле Антона и компании;
  - с мягкими ссылками на бота и консультации.

**Автопостинг (позже):**
- На первом этапе — только генерация черновиков.
- На следующем — режим автопостинга по расписанию в Telegram-канал (через отдельный сервис/скрипт).

**Интеграция:**
- Отдельный бриф `BRIEF_content_agent_channel_pereplanirovki.md`.
- Используется вручную + через отдельного помощника/скрипт для публикаций.

---

### 2. Agent парсинга и привлечения подписчиков

**Задачи:**
- Мониторинг внешних источников:
  - тематические каналы, форумы, новости по перепланировкам и недвижимости;
  - выделение актуальных тем и вопросов клиентов.
- Генерация материалов для привлечения:
  - тексты для рекламы, таргета, взаимопиаров;
  - лид-магниты (чек-листы, мини-гайды).

**Выходы:**
- Список актуальных тем для постов и видео;
- Черновики рекламных объявлений;
- Предложения по входным офферам.

---

### 3. Agent личных консультаций по объектам

**Задачи:**
- На основе данных из квиза/диалога:
  - собрать структурированное описание объекта (город, тип дома, этаж, БТИ, планируемые изменения);
  - оценить риски и сложные места;
  - дать менеджеру краткую записку для подготовки к звонку/консультации.

**Интеграция:**
- Расширение текущей функции `generate_manager_brief`;
- Отдельный бриф с правилами анализа объектов (`BRIEF_object_consult_agent.md`).

---

### 4. Agent лендинга по перепланировкам

**Задачи:**
- Проектировать структуру лендинга:
  - блоки: оффер, доверие, кейсы, FAQ, форма заявки, связка с ботом.
- Писать тексты для лендинга:
  - для клиентов по перепланировкам (квартиры, коммерция, дома).
- Предлагать варианты A/B-тестов:
  - разные формулировки офферов, блоков, CTA.

**Интеграция:**
- Бриф `BRIEF_landing_pereplanirovki.md`;
- Работа через Comet + VS Code-агент по коду лендинга.

---

### 5. Agent по оплатам (позже)

**Задачи (будущее):**
- Проектировать модель оплаты:
  - пакеты услуг и тарифы;
  - структура предоплаты/этапов.
- Формировать сценарии продаж:
  - когда и как предлагать оплату в боте;
  - как связать оплату с конкретной заявкой и объектом.

**Интеграция:**
- Не реализует сам платежи, а готовит ТЗ и тексты для интеграции с платежными системами.
